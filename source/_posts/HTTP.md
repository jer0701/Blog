---
title: HTTP学习
date: 2017-04-05 16:00:28
tags:
     - HTTP
     - TCP/IP
---

HTTP（Hypertext Transfer Protocol，超文本传输协议）是在万维网上进行通信时所使用的协议方案，是一个应用层协议。

前端必不可少的需要了解到它。

<!--more-->

关于HTTP的内容有很多，如URI、HTTP事务、HTTP报文、HTTP连接等。

抛开其他，本文只对HTTP连接先进行赘述。

</br>

#### 连接

HTTP是个应用层协议，它无需操心网络通信的具体细节，它把联网的细节都交给了通用、可靠的因特网传输协议TCP/IP

TCP（Transmission Control Protocol，传输控制协议）提供了：

* 无差错的数据传输；
* 按序传输（数据总是会按照发送的顺序到达）；
* 未分段的数据流（可以在任意时刻以任意尺寸将数据发送出去）。

在客户端向服务器发送报文之前，需要用网际协议（Internet Protocol，IP）地址和端口号在客户端和服务器之间建立一条TCP/IP连接。只要建立了TCP连接，客户端和服务器之间的报文交换就不会丢失，不会被破坏，也不会在接收时出现错序。

</br>



#### TCP连接

HTTP连接实际上就是TCP连接。TCP为HTTP提供了一条*可靠的比特传输管道*。从TCP连接一端填入的字节会从另一端以原有的顺序、正确地传送出来。



##### TCP流

TCP的数据是通过IP数据报的小数据块来发送的。HTTP要传送一条报文时，会以流的形式将报文数据的内容通过一条打开的TCP连接按序传输。TCP接收到数据流之后，会将数据流砍成被称作段的小数据块，并将段封装在IP数据报中，通过因特网传输。

每个TCP段都是有IP数据报承载，从一个IP地址发送到另一个IP地址。IP数据报包括：

* 一个IP数据报首部
* 一个TCP段首部
* 一个TCP数据块

IP首部包含了源和目的的IP地址、长度和其他一些标记。TCP段的首部包含了TCP端口号、TCP控制标记、以及用于数据排序和完整性检查的一些数字值。



##### TCP连接

TCP采用三次握手建立一个连接：

![三次握手](http://pic002.cnblogs.com/images/2011/305779/2011062613192683.jpg)

```wiki
第一次握手：建立连接时,客户端发送SYN（synchronous）包(SYN=J)到服务器,并进入SYN_SEND状态,等待服务器确认；

第二次握手：服务器收到SYN包,必须确认客户的SYN（ack=J+1）,同时自己也发送一个SYN包（SYN=K）,即SYN+ACK包,此时服务器进入SYN_RECV状态；

第三次握手：客户端收到服务器的SYN＋ACK包,向服务器发送确认包ACK(ack=K+1),此包发送完毕,客户端和服务器进入ESTABLISHED状态,完成三次握手.
```



三次握手完成，客户端与服务器开始传送数据



TCP四次挥手断开连接：

![四次挥手](http://pic002.cnblogs.com/images/2011/305779/2011062613210341.jpg)

```wiki
客户端发送一个FIN（finish） M，用来关闭客户到服务器的数据传送

服务器收到这个FIN，它发回一个ACK，确认序号为收到的序号加1。和SYN一样，一个FIN将占用一个序号。

服务器关闭与客户端的连接，发送一个FIN N给客户端。

客户端发回ACK报文确认，并将确认序号设置为收到序号加1
```



通过上述连接过程可以看出，TCP连接是需要时间的，所以减少HTTP请求一方面也是减少TCP连接的次数，节约了时间。



###### PS：图片来源网络，侵删。

本文参考HTTP权威指南一书。